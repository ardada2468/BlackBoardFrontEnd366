{"version":3,"sources":["../source/html.js"],"names":["render","renderErrorStack","default_options","font_size","error","options","result","getErrorPageStyle","ERROR_STACK_STYLE","replace","groups","stack","groups_markup","map","group","i","list_items_markup","lines","line_markup","line","join","markup","escape_html","title","line_info","file_path","file_name","file_line_number","method_path","length","split","text"],"mappings":";;;;;;kBAOwBA,M;QAsBRC,gB,GAAAA,gB;;AA7BhB;;;;AACA;;;;AAEA,IAAMC,kBAAkB;AACvBC,YAAW;AADY,CAAxB;;AAIe,SAASH,MAAT,CAAgBI,KAAhB,EACf;AAAA,KADsCC,OACtC,uEADgD,EAChD;;AACCA,WAAU,oBAAMH,eAAN,EAAuB,sCAAwB,oBAAMG,OAAN,CAAxB,CAAvB,CAAV;;AAEA,KAAMC,wEAKL,uBAASC,kBAAkBF,OAAlB,CAAT,EAAqC,CAArC,CALK,UAML,uBAASG,iBAAT,EAA4B,CAA5B,CANK,uCAQMP,iBAAiBG,KAAjB,CARN,qCAAN;;AAaA,QAAO,uBAASE,MAAT,EAAiB,CAAC,CAAlB,EACLG,OADK,CACG,KADH,EACU,EADV,EAELA,OAFK,CAEG,KAFH,EAEU,EAFV,CAAP;AAGA;;AAEM,SAASR,gBAAT,CAA0BG,KAA1B,EACP;AACC,KAAMM,SAAS,qBAAkBN,MAAMO,KAAxB,CAAf;;AAEA,KAAMC,gBAAgBF,OAAOG,GAAP,CAAW,UAACC,KAAD,EAAQC,CAAR,EACjC;AACC,MAAMC,oBAAoBF,MAAMG,KAAN,CAAYJ,GAAZ,CAAgB,gBAC1C;AACC,UAAO,0CAA0C,IAA1C,GAAiD,uBAASK,YAAYC,IAAZ,CAAT,EAA4B,CAA5B,CAAjD,GAAkF,IAAlF,GAAyF,OAAhG;AACA,GAHyB,EAIzBC,IAJyB,CAIpB,IAJoB,CAA1B;;AAMA,MAAMC,4DAEkCN,MAAM,CAAN,GAAU,EAAV,GAAe,wCAFjD,WAE+FO,YAAYR,MAAMS,KAAlB,CAF/F,qDAG6B,uBAASP,iBAAT,EAA4B,CAA5B,CAH7B,kBAAN;;AAMA,SAAO,uBAASK,MAAT,EAAiB,CAAC,CAAlB,CAAP;AACA,EAfqB,EAgBrBD,IAhBqB,CAgBhB,EAhBgB,EAiBrBX,OAjBqB,CAiBb,KAjBa,EAiBN,EAjBM,EAkBrBA,OAlBqB,CAkBb,KAlBa,EAkBN,EAlBM,CAAtB;;AAoBA,QAAO,uBAASG,aAAT,EAAwB,CAAxB,CAAP;AACA;;AAED,SAASM,WAAT,CAAqBM,SAArB,EACA;AACC,KAAI,OAAOA,SAAP,KAAqB,QAAzB,EACA;AACC,SAAOA,SAAP;AACA;;AAED,KAAIL,OAAO,EAAX;;AAEA,KAAIK,UAAUC,SAAd,EACA;AACCN,0DAAsDK,UAAUE,SAAhE;AACA;;AAED,KAAIF,UAAUG,gBAAd,EACA;AACCR,2GAAuGK,UAAUG,gBAAjH;AACA;;AAED,KAAIH,UAAUI,WAAd,EACA;AACC,MAAIT,KAAKU,MAAL,GAAc,CAAlB,EACA;AACCV,WAAQ,GAAR;AACA;;AAEDA,uDAAmDG,YAAYE,UAAUI,WAAtB,CAAnD;AACA;;AAED,KAAIJ,UAAUC,SAAd,EACA;AACCN,UAAQ,OAAO,8EAEZG,YAAYE,UAAUC,SAAtB,EAAiCK,KAAjC,CAAuC,GAAvC,EAA4CV,IAA5C,CAAiD,+DAAjD,CAFY,mBAIf,CAAC,CAJc,CAAf;AAKA;;AAED,QAAOD,IAAP;AACA;;AAED,SAASG,WAAT,CAAqBS,IAArB,EACA;AACC,QAAOA,KAAKtB,OAAL,CAAa,IAAb,EAAkB,OAAlB,EAA2BA,OAA3B,CAAmC,IAAnC,EAAwC,MAAxC,EAAgDA,OAAhD,CAAwD,IAAxD,EAA6D,MAA7D,CAAP;AACA;;AAEM,IAAMD,gDAAoB,y8BA0DjC,CAAC,CA1DgC,CAA1B;;AA4DP,SAASD,iBAAT,CAA2BF,OAA3B,EACA;AACC,QAAO,6HAMYA,QAAQF,SANpB,+LAiBP,CAAC,CAjBM,CAAP;AAkBA","file":"html.js","sourcesContent":["import parse_stack_trace from './parse.js'\r\nimport { merge, clone, tabulate, convert_from_camel_case } from './helpers.js'\r\n\r\nconst default_options = {\r\n\tfont_size: '20px'\r\n}\r\n\r\nexport default function render(error, options = {})\r\n{\r\n\toptions = merge(default_options, convert_from_camel_case(clone(options)))\r\n\r\n\tconst result =\r\n\t`\r\n\t\t<html>\r\n\t\t\t<head>\r\n\t\t\t\t<title>Error</title>\r\n${tabulate(getErrorPageStyle(options), 4)}\r\n${tabulate(ERROR_STACK_STYLE, 4)}\r\n\t\t\t</head>\r\n\t\t\t<body>\\n${renderErrorStack(error)}\r\n\t\t\t</body>\r\n\t\t</html>\r\n\t`\r\n\r\n\treturn tabulate(result, -2)\r\n\t\t.replace(/^\\n/, '')\r\n\t\t.replace(/\\n$/, '')\r\n}\r\n\r\nexport function renderErrorStack(error)\r\n{\r\n\tconst groups = parse_stack_trace(error.stack)\r\n\r\n\tconst groups_markup = groups.map((group, i) =>\r\n\t{\r\n\t\tconst list_items_markup = group.lines.map(line =>\r\n\t\t{\r\n\t\t\treturn '<li class=\"print-error-stack__entry\">' + '\\n' + tabulate(line_markup(line), 1) + '\\n' + '</li>'\r\n\t\t})\r\n\t\t.join('\\n')\r\n\r\n\t\tconst markup =\r\n\t\t`\r\n\t\t\t<h1 class=\"print-error-stack__heading${i === 0 ? '' : ' print-error-stack__heading--secondary' }\">${escape_html(group.title)}</h1>\r\n\t\t\t<ul class=\"print-error-stack\">\\n${tabulate(list_items_markup, 4)}\r\n\t\t\t</ul>`\r\n\t\t\r\n\t\treturn tabulate(markup, -3)\r\n\t})\r\n\t.join('')\r\n\t.replace(/^\\n/, '')\r\n\t.replace(/\\n$/, '')\r\n\r\n\treturn tabulate(groups_markup, 4)\r\n}\r\n\r\nfunction line_markup(line_info)\r\n{\r\n\tif (typeof line_info === 'string')\r\n\t{\r\n\t\treturn line_info\r\n\t}\r\n\r\n\tlet line = ''\r\n\r\n\tif (line_info.file_path)\r\n\t{\r\n\t\tline += `<span class=\"print-error-stack__file-name\">${line_info.file_name}</span>`\r\n\t}\r\n\r\n\tif (line_info.file_line_number)\r\n\t{\r\n\t\tline += `<span class=\"print-error-stack__colon\">:</span><span class=\"print-error-stack__line-number\">${line_info.file_line_number}</span>`\r\n\t}\r\n\r\n\tif (line_info.method_path)\r\n\t{\r\n\t\tif (line.length > 0)\r\n\t\t{\r\n\t\t\tline += ' '\r\n\t\t}\r\n\r\n\t\tline += `<span class=\"print-error-stack__method\">${escape_html(line_info.method_path)}</span>`\r\n\t}\r\n\r\n\tif (line_info.file_path)\r\n\t{\t\r\n\t\tline += '\\n' + tabulate(\r\n\t\t`<div class=\"print-error-stack__file-path\">\r\n\t\t\t${escape_html(line_info.file_path).split('/').join('<span class=\"print-error-stack__file-path-separator\">/</span>')}\r\n\t\t</div>`,\r\n\t\t-2)\r\n\t}\r\n\r\n\treturn line\r\n}\r\n\r\nfunction escape_html(text)\r\n{\r\n\treturn text.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')\r\n}\r\n\r\nexport const ERROR_STACK_STYLE = tabulate\r\n(\r\n`\t<style>\r\n\t\t.print-error-stack__heading\r\n\t\t{\r\n\t\t\tfont-size : 140%;\r\n\t\t\tcolor     : #C44100;\r\n\t\t}\r\n\r\n\t\t.print-error-stack__heading--secondary\r\n\t\t{\r\n\t\t\tfont-weight : normal;\r\n\t\t\tcolor       : #7f7f7f;\r\n\t\t}\r\n\r\n\t\t.print-error-stack\r\n\t\t{\r\n\t\t\tmargin-top : 2em;\r\n\t\t}\r\n\r\n\t\t.print-error-stack__entry\r\n\t\t{\r\n\t\t\tmargin-bottom   : 1.5em;\r\n\t\t\tlist-style-type : none;\r\n\t\t\tfont-size       : 120%;\r\n\t\t}\r\n\r\n\t\t.print-error-stack__file-path\r\n\t\t{\r\n\t\t\tcolor         : #7f7f7f;\r\n\t\t\tmargin-top    : 0.8em;\r\n\t\t}\r\n\r\n\t\t.print-error-stack__file-path-separator\r\n\t\t{\r\n\t\t\tcolor : #c0c0c0;\r\n\t\t}\r\n\r\n\t\t.print-error-stack__file-name\r\n\t\t{\r\n\t\t\tfont-weight : bold;\r\n\t\t}\r\n\r\n\t\t.print-error-stack__line-number\r\n\t\t{\r\n\t\t}\r\n\r\n\t\t.print-error-stack__colon\r\n\t\t{\r\n\t\t\tcolor: #9f9f9f;\r\n\t\t}\r\n\r\n\t\t.print-error-stack__method\r\n\t\t{\r\n\t\t\tcolor: #0091C2;\r\n\t\t\tfont-weight: bold;\r\n\t\t}\r\n\t</style>`,\r\n-1)\r\n\r\nfunction getErrorPageStyle(options)\r\n{\r\n\treturn tabulate\r\n\t(\r\n`\t\t<style>\r\n\t\t\thtml\r\n\t\t\t{\r\n\t\t\t\tfont-family : Monospace, Arial;\r\n\t\t\t\tfont-size   : ${options.font_size};\r\n\t\t\t}\r\n\r\n\t\t\tbody\r\n\t\t\t{\r\n\t\t\t\tmargin-top    : 1.6em;\r\n\t\t\t\tmargin-bottom : 1.6em;\r\n\t\t\t\tmargin-left   : 2.3em;\r\n\t\t\t\tmargin-right  : 2.3em;\r\n\t\t\t}\r\n\t\t</style>`,\r\n\t-2)\r\n}"]}
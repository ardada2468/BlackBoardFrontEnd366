{"version":3,"sources":["../../../source/redux/client/initialPreload.js"],"names":["nodes","refs","LoadingContainer","loading","state","React","Component","showInitialPreload","node","document","createElement","push","body","insertBefore","firstChild","setRef","ref","index","indexOf","ReactDOM","render","hideInitialPreload","pop","setState","setTimeout","unmountComponentAtNode","removeChild"],"mappings":";;;;;;;;AAAA;;AACA;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;AAMA,IAAIA,KAAK,GAAG,EAAZ;AACA,IAAIC,IAAI,GAAG,EAAX;;IAEMC,gB;;;;;;;;;;;;;;;;;;4DACG;AACPC,MAAAA,OAAO,EAAE;AADF,K;;;;;;;6BAGC;AAAA,UACAA,OADA,GACY,KAAKC,KADjB,CACAD,OADA;AAER,aACC,gCAAC,gBAAD;AACC,QAAA,OAAO,EAAEA,OADV;AAEC,QAAA,SAAS,EAAEA,OAFZ;AAGC,QAAA,OAAO,EAAEA;AAHV,QADD;AAMA;;;;EAZ6BE,kBAAMC,S;;AAe9B,SAASC,kBAAT,GAA8B;AACpC,MAAMC,IAAI,GAAGC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAb;AACAV,EAAAA,KAAK,CAACW,IAAN,CAAWH,IAAX,EAFoC,CAGpC;AACA;;AACAC,EAAAA,QAAQ,CAACG,IAAT,CAAcC,YAAd,CAA2BL,IAA3B,EAAiCC,QAAQ,CAACG,IAAT,CAAcE,UAA/C;;AACA,MAAMC,MAAM,GAAG,SAATA,MAAS,CAACC,GAAD,EAAS;AACvB,QAAMC,KAAK,GAAGjB,KAAK,CAACkB,OAAN,CAAcV,IAAd,CAAd;;AACA,QAAIS,KAAK,IAAI,CAAb,EAAgB;AACfhB,MAAAA,IAAI,CAACgB,KAAD,CAAJ,GAAcD,GAAd;AACA;AACD,GALD;;AAMAG,uBAASC,MAAT,CAAgB,gCAAC,gBAAD;AAAkB,IAAA,GAAG,EAAEL;AAAvB,IAAhB,EAAkDP,IAAlD;AACA;;AAEM,SAASa,kBAAT,GAA8B;AACpC,MAAMb,IAAI,GAAGR,KAAK,CAACsB,GAAN,EAAb;AACA,MAAMN,GAAG,GAAGf,IAAI,CAACqB,GAAL,EAAZ;AACAN,EAAAA,GAAG,CAACO,QAAJ,CAAa;AAAEpB,IAAAA,OAAO,EAAE;AAAX,GAAb,EAAiC,YAAM;AACtCqB,IAAAA,UAAU,CAAC,YAAM;AAChBL,2BAASM,sBAAT,CAAgCjB,IAAhC;;AACAC,MAAAA,QAAQ,CAACG,IAAT,CAAcc,WAAd,CAA0BlB,IAA1B;AACA,KAHS,EAGP,GAHO,CAAV;AAIA,GALD;AAMA","sourcesContent":["import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\n\r\nimport { Loading } from '../../components/Loading'\r\n\r\n// In cases when the initial page immediately redirects\r\n// to another page (for example, to a \"not found\" page),\r\n// `node` and `ref` would get overwritten have they been\r\n// simple variables and not arrays.\r\nlet nodes = []\r\nlet refs = []\r\n\r\nclass LoadingContainer extends React.Component {\r\n\tstate = {\r\n\t\tloading: true\r\n\t}\r\n\trender() {\r\n\t\tconst { loading } = this.state\r\n\t\treturn (\r\n\t\t\t<Loading\r\n\t\t\t\tinitial={loading}\r\n\t\t\t\timmediate={loading}\r\n\t\t\t\tpending={loading}/>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport function showInitialPreload() {\r\n\tconst node = document.createElement('div')\r\n\tnodes.push(node)\r\n\t// Will prepend `element` to `<body/>` (even if `<body/>` is empty).\r\n\t// https://stackoverflow.com/questions/2007357/how-to-set-dom-element-as-the-first-child\r\n\tdocument.body.insertBefore(node, document.body.firstChild)\r\n\tconst setRef = (ref) => {\r\n\t\tconst index = nodes.indexOf(node)\r\n\t\tif (index >= 0) {\r\n\t\t\trefs[index] = ref\r\n\t\t}\r\n\t}\r\n\tReactDOM.render(<LoadingContainer ref={setRef}/>, node)\r\n}\r\n\r\nexport function hideInitialPreload() {\r\n\tconst node = nodes.pop()\r\n\tconst ref = refs.pop()\r\n\tref.setState({ loading: false }, () => {\r\n\t\tsetTimeout(() => {\r\n\t\t\tReactDOM.unmountComponentAtNode(node)\r\n\t\t\tdocument.body.removeChild(node)\r\n\t\t}, 160)\r\n\t})\r\n}"],"file":"initialPreload.js"}
{"version":3,"sources":["../../source/redux/ReduxModule.js"],"names":["ReduxModule","namespace","counter","next","settings","reduxEventNaming","DEFAULT_REDUX_EVENT_NAMING","reduxPropertyNaming","underscoredToCamelCase","event","handler","Array","isArray","handlers","undefined","push","action","result","options","createAction","sync","initialState","state","type","getEventData","error","console","reducer","createReducer","_react_pages_events","Object","keys","prototype","hasOwnProperty","call","RESULT_ACTION_PROPERTY","ERROR_ACTION_PROPERTY","registered_state_properties","apply","arguments","add_state_properties","redux","on","get_action_value_reducer","argument","add_asynchronous_action_reducers","parameters","promise","http","result_reducer","pending_event_name","success_event_name","error_event_name","pending_property_name","error_property_name","value","updated_properties","property","Counter","MAX_SAFE_INTEGER","Number","Math","pow"],"mappings":"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","sourcesContent":["import {\r\n\teventName,\r\n\tunderscoredToCamelCase,\r\n\tDEFAULT_REDUX_EVENT_NAMING,\r\n\tgenerateReduxNamespace,\r\n\tgenerateReduxEventName\r\n} from './naming'\r\n\r\nimport {\r\n\tRESULT_ACTION_PROPERTY,\r\n\tERROR_ACTION_PROPERTY\r\n} from './middleware/asynchronous'\r\n\r\n// Sometimes modules for one project are imported from another project directory.\r\n// For example, Redux actions from one project may be imported into another project.\r\n// In such cases `Counter` is not enough because Redux event names would collide\r\n// because actions from the first project use different `node_modules` and therefore\r\n// use different `react-pages` modules having their own `Counter`.\r\n// In such cases it's mandatory to pass Redux event name to `.action()` and `.simpleAction()`.\r\n// Otherwise there will be Redux event name collisions.\r\n// Importing packages from two different `node_modules` is not a good practice.\r\n\r\nexport default class ReduxModule {\r\n\thandlers = {}\r\n\tregistered_state_properties = []\r\n\r\n\tconstructor(namespace = generateReduxNamespace(counter.next()), settings = {}) {\r\n\t\tthis.namespace = namespace\r\n\t\tthis.settings = {\r\n\t\t\treduxEventNaming: settings.reduxEventNaming || DEFAULT_REDUX_EVENT_NAMING,\r\n\t\t\treduxPropertyNaming: settings.reduxPropertyNaming || underscoredToCamelCase\r\n\t\t}\r\n\t}\r\n\r\n\treplace(event, handler) {\r\n\t\tif (!Array.isArray(handler)) {\r\n\t\t\thandler = [handler]\r\n\t\t}\r\n\t\tthis.handlers[event] = handler\r\n\t}\r\n\r\n\ton(namespace, event, handler) {\r\n\t\tif (typeof event === 'function') {\r\n\t\t\thandler = event\r\n\t\t\tevent = namespace\r\n\t\t\tnamespace = undefined\r\n\t\t} else {\r\n\t\t\t// Use \"success\" event name.\r\n\t\t\tevent = this.settings.reduxEventNaming(eventName(namespace, event))[1]\r\n\t\t}\r\n\t\tif (!this.handlers[event]) {\r\n\t\t\tthis.handlers[event] = []\r\n\t\t}\r\n\t\tthis.handlers[event].push(handler)\r\n\t}\r\n\r\n\taction(event, action, result, options) {\r\n\t\tif (event && typeof event !== 'string') {\r\n\t\t\toptions = result\r\n\t\t\tresult = action\r\n\t\t\taction = event\r\n\t\t\tevent = undefined\r\n\t\t}\r\n\t\t// Autogenerate `event` name.\r\n\t\tif (!event) {\r\n\t\t\tevent = generateReduxEventName(counter.next())\r\n\t\t}\r\n\t\toptions = options || {}\r\n\t\treturn createAction(event, action, result, options, this)\r\n\t}\r\n\r\n\tsimpleAction(event, result) {\r\n\t\tif (event && typeof event !== 'string') {\r\n\t\t\tresult = event\r\n\t\t\tevent = undefined\r\n\t\t}\r\n\t\treturn this.action(event, undefined, result, { sync: true })\r\n\t}\r\n\r\n\tcreateReducer(initialState = {}) {\r\n\t\t// Applies a handler based on the Redux action `type`.\r\n\t\t// (is copy & paste'd for all action response handlers)\r\n\t\treturn (state = initialState, event = {}) => {\r\n\t\t\ttry {\r\n\t\t\t\tfor (const handler of (this.handlers[event.type] || [])) {\r\n\t\t\t\t\tstate = handler(state, this.getEventData(event))\r\n\t\t\t\t}\r\n\t\t\t\treturn state\r\n\t\t\t} catch (error) {\r\n\t\t\t\t// For some strange reason Redux didn't report\r\n\t\t\t\t// these errors to the console, hence the manual `console.error`.\r\n\t\t\t\tconsole.error(error)\r\n\t\t\t\tthrow error\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treducer(initialState = {}) {\r\n\t\tconst reducer = this.createReducer(initialState)\r\n\t\t// The event names list is used for autogenerated\r\n\t\t// event names conflict detection.\r\n\t\t// See `checkForAutogeneratedEventNameCollision()`.\r\n\t\treducer._react_pages_events = Object.keys(this.handlers)\r\n\t\treturn reducer\r\n\t}\r\n\r\n\tgetEventData(event) {\r\n\t\tif (Object.prototype.hasOwnProperty.call(event, RESULT_ACTION_PROPERTY)) {\r\n\t\t\treturn event[RESULT_ACTION_PROPERTY]\r\n\t\t} else if (event[ERROR_ACTION_PROPERTY] !== undefined) {\r\n\t\t\treturn event[ERROR_ACTION_PROPERTY]\r\n\t\t} else {\r\n\t\t\treturn event\r\n\t\t}\r\n\t}\r\n\r\n\tadd_state_properties() {\r\n\t\tthis.registered_state_properties.push.apply(this.registered_state_properties, arguments)\r\n\t}\r\n\r\n\t// Public alias.\r\n\tproperties() {\r\n\t\tthis.add_state_properties.apply(this, arguments)\r\n\t}\r\n\r\n\t// Public alias.\r\n\tproperty() {\r\n\t\tthis.add_state_properties.apply(this, arguments)\r\n\t}\r\n}\r\n\r\n// Returns Redux action creator.\r\nfunction createAction(event, action, result, options, redux) {\r\n\tconst namespace = redux.namespace\r\n\tconst { sync } = options\r\n\r\n\t// If `result` is a property name,\r\n\t// then add that property to `connectXxx()`.\r\n\tif (typeof result === 'string') {\r\n\t\tredux.add_state_properties(result)\r\n\t}\r\n\t// If `result` is an object of property getters,\r\n\t// then add those properties to `connectXxx()`.\r\n\telse if (typeof result === 'object') {\r\n\t\tredux.add_state_properties(...Object.keys(result))\r\n\t}\r\n\r\n\t// Default \"on result\" handler is a reducer that does nothing.\r\n\t// For example, when Redux action result is ignored.\r\n\t// (I guess those would be rare cases, like \"send log message\")\r\n\tresult = result || (state => state)\r\n\r\n\t// Synchronous action\r\n\tif (sync) {\r\n\t\t// Reducer\r\n\t\tredux.on(eventName(namespace, event), get_action_value_reducer(result))\r\n\t\t// Redux \"action creator\"\r\n\t\treturn (argument) => ({\r\n\t\t\ttype: eventName(namespace, event),\r\n\t\t\t[RESULT_ACTION_PROPERTY]: argument\r\n\t\t})\r\n\t}\r\n\r\n\t// Asynchronous action\r\n\r\n\t// Add Redux reducers handling events:\r\n\t//\r\n\t//   * pending\r\n\t//   * success\r\n\t//   * error\r\n\t//\r\n\tadd_asynchronous_action_reducers(redux, namespace, event, get_action_value_reducer(result))\r\n\r\n\t// Redux \"action creator\"\r\n\treturn (...parameters) => ({\r\n\t\tevent: eventName(namespace, event),\r\n\t\tpromise: ({ http }) => action.apply(this, parameters)(http)\r\n\t})\r\n}\r\n\r\n// Adds handlers for:\r\n//\r\n//   * pending\r\n//   * done\r\n//   * failed\r\n//   * reset error\r\n//\r\nfunction add_asynchronous_action_reducers(redux, namespace, event, result_reducer) {\r\n\tconst\r\n\t[\r\n\t\tpending_event_name,\r\n\t\tsuccess_event_name,\r\n\t\terror_event_name\r\n\t]\r\n\t= redux.settings.reduxEventNaming(event)\r\n\r\n\tconst pending_property_name = redux.settings.reduxPropertyNaming(pending_event_name)\r\n\tconst error_property_name   = redux.settings.reduxPropertyNaming(error_event_name)\r\n\r\n\t// This info will be used in `storeConnector`\r\n\tredux.add_state_properties(pending_property_name, error_property_name)\r\n\r\n\t// When Promise is created: reset result variable, clear `error`, set `pending` flag.\r\n\tredux.on(eventName(namespace, pending_event_name), (state) => {\r\n\t\tstate = {\r\n\t\t\t...state,\r\n\t\t\t// Set `pending` flag\r\n\t\t\t[pending_property_name]: true\r\n\t\t}\r\n\t\t// Clear `error`\r\n\t\tdelete state[error_property_name]\r\n\t\treturn state\r\n\t})\r\n\r\n\t// When Promise succeeds: clear `pending` flag, set result variable.\r\n\tredux.on(eventName(namespace, success_event_name), (state, result) => {\r\n\t\tstate = result_reducer(state, result)\r\n\t\tdelete state[pending_property_name]\r\n\t\treturn state\r\n\t})\r\n\r\n\t// When Promise fails, clear `pending` flag and set `error`.\r\n\t// Can also clear `error` when no `error` is passed as part of an action.\r\n\tredux.on(eventName(namespace, error_event_name), (state, error) => {\r\n\t\tstate = {\r\n\t\t\t...state,\r\n\t\t\t[error_property_name]: error\r\n\t\t}\r\n\t\t// Clear `pending` flag\r\n\t\tdelete state[pending_property_name]\r\n\t\treturn state\r\n\t})\r\n}\r\n\r\n// Returns a function\r\nfunction get_action_value_reducer(reducer) {\r\n\t// If `reducer` is a property name,\r\n\t// then the reducer will write action value\r\n\t// to that property of Redux state.\r\n\tif (typeof reducer === 'string') {\r\n\t\treturn (state, value) => ({\r\n\t\t\t...state,\r\n\t\t\t[reducer]: value\r\n\t\t})\r\n\t}\r\n\r\n\t// If `reducer` is an object of property getters\r\n\t// then those properties will be added to Redux state.\r\n\tif (typeof reducer === 'object') {\r\n\t\treturn (state, value) => {\r\n\t\t\tconst updated_properties = {}\r\n\t\t\tfor (const property of Object.keys(reducer)) {\r\n\t\t\t\tupdated_properties[property] = reducer[property](value)\r\n\t\t\t\t// Don't know why did I previously write it like:\r\n\t\t\t\t// updated_properties =\r\n\t\t\t\t// {\r\n\t\t\t\t// \t...updated_properties,\r\n\t\t\t\t// \t...reducer[property](value)\r\n\t\t\t\t// }\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\t...updated_properties\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// Otherwise `reducer` is `(state, value) => ...`\r\n\treturn reducer\r\n}\r\n\r\nclass Counter {\r\n\tcounter = 0\r\n\tnext() {\r\n\t\tif (this.counter < MAX_SAFE_INTEGER) {\r\n\t\t\tthis.counter++\r\n\t\t} else {\r\n\t\t\tthis.counter = 1\r\n\t\t}\r\n\t\treturn this.counter\r\n\t}\r\n}\r\n\r\nconst counter = new Counter()\r\n\r\n// `MAX_SAFE_INTEGER` is not supported by older browsers\r\nconst MAX_SAFE_INTEGER = Number.MAX_SAFE_INTEGER || Math.pow(2, 53) - 1\r\n"],"file":"ReduxModule.js"}
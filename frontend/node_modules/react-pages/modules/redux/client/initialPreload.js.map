{"version":3,"sources":["../../../source/redux/client/initialPreload.js"],"names":["React","ReactDOM","Loading","nodes","refs","LoadingContainer","loading","state","Component","showInitialPreload","node","document","createElement","push","body","insertBefore","firstChild","setRef","ref","index","indexOf","render","hideInitialPreload","pop","setState","setTimeout","unmountComponentAtNode","removeChild"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,QAAP,MAAqB,WAArB;AAEA,SAASC,OAAT,QAAwB,0BAAxB,C,CAEA;AACA;AACA;AACA;;AACA,IAAIC,KAAK,GAAG,EAAZ;AACA,IAAIC,IAAI,GAAG,EAAX;;IAEMC,gB;;;;;;;;;;;;;;;;;;4DACG;AACPC,MAAAA,OAAO,EAAE;AADF,K;;;;;;;6BAGC;AAAA,UACAA,OADA,GACY,KAAKC,KADjB,CACAD,OADA;AAER,aACC,oBAAC,OAAD;AACC,QAAA,OAAO,EAAEA,OADV;AAEC,QAAA,SAAS,EAAEA,OAFZ;AAGC,QAAA,OAAO,EAAEA;AAHV,QADD;AAMA;;;;EAZ6BN,KAAK,CAACQ,S;;AAerC,OAAO,SAASC,kBAAT,GAA8B;AACpC,MAAMC,IAAI,GAAGC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAb;AACAT,EAAAA,KAAK,CAACU,IAAN,CAAWH,IAAX,EAFoC,CAGpC;AACA;;AACAC,EAAAA,QAAQ,CAACG,IAAT,CAAcC,YAAd,CAA2BL,IAA3B,EAAiCC,QAAQ,CAACG,IAAT,CAAcE,UAA/C;;AACA,MAAMC,MAAM,GAAG,SAATA,MAAS,CAACC,GAAD,EAAS;AACvB,QAAMC,KAAK,GAAGhB,KAAK,CAACiB,OAAN,CAAcV,IAAd,CAAd;;AACA,QAAIS,KAAK,IAAI,CAAb,EAAgB;AACff,MAAAA,IAAI,CAACe,KAAD,CAAJ,GAAcD,GAAd;AACA;AACD,GALD;;AAMAjB,EAAAA,QAAQ,CAACoB,MAAT,CAAgB,oBAAC,gBAAD;AAAkB,IAAA,GAAG,EAAEJ;AAAvB,IAAhB,EAAkDP,IAAlD;AACA;AAED,OAAO,SAASY,kBAAT,GAA8B;AACpC,MAAMZ,IAAI,GAAGP,KAAK,CAACoB,GAAN,EAAb;AACA,MAAML,GAAG,GAAGd,IAAI,CAACmB,GAAL,EAAZ;AACAL,EAAAA,GAAG,CAACM,QAAJ,CAAa;AAAElB,IAAAA,OAAO,EAAE;AAAX,GAAb,EAAiC,YAAM;AACtCmB,IAAAA,UAAU,CAAC,YAAM;AAChBxB,MAAAA,QAAQ,CAACyB,sBAAT,CAAgChB,IAAhC;AACAC,MAAAA,QAAQ,CAACG,IAAT,CAAca,WAAd,CAA0BjB,IAA1B;AACA,KAHS,EAGP,GAHO,CAAV;AAIA,GALD;AAMA","sourcesContent":["import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\n\r\nimport { Loading } from '../../components/Loading'\r\n\r\n// In cases when the initial page immediately redirects\r\n// to another page (for example, to a \"not found\" page),\r\n// `node` and `ref` would get overwritten have they been\r\n// simple variables and not arrays.\r\nlet nodes = []\r\nlet refs = []\r\n\r\nclass LoadingContainer extends React.Component {\r\n\tstate = {\r\n\t\tloading: true\r\n\t}\r\n\trender() {\r\n\t\tconst { loading } = this.state\r\n\t\treturn (\r\n\t\t\t<Loading\r\n\t\t\t\tinitial={loading}\r\n\t\t\t\timmediate={loading}\r\n\t\t\t\tpending={loading}/>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport function showInitialPreload() {\r\n\tconst node = document.createElement('div')\r\n\tnodes.push(node)\r\n\t// Will prepend `element` to `<body/>` (even if `<body/>` is empty).\r\n\t// https://stackoverflow.com/questions/2007357/how-to-set-dom-element-as-the-first-child\r\n\tdocument.body.insertBefore(node, document.body.firstChild)\r\n\tconst setRef = (ref) => {\r\n\t\tconst index = nodes.indexOf(node)\r\n\t\tif (index >= 0) {\r\n\t\t\trefs[index] = ref\r\n\t\t}\r\n\t}\r\n\tReactDOM.render(<LoadingContainer ref={setRef}/>, node)\r\n}\r\n\r\nexport function hideInitialPreload() {\r\n\tconst node = nodes.pop()\r\n\tconst ref = refs.pop()\r\n\tref.setState({ loading: false }, () => {\r\n\t\tsetTimeout(() => {\r\n\t\t\tReactDOM.unmountComponentAtNode(node)\r\n\t\t\tdocument.body.removeChild(node)\r\n\t\t}, 160)\r\n\t})\r\n}"],"file":"initialPreload.js"}